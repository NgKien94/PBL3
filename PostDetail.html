
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Post Details</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="./asset/css/PostDetail.css">
</head>

<body>


  <div class="blog-single gray-bg">
    <div class="container">
      <div class="row align-items-start">
        <div class="col-lg-8 m-15px-tb">
          <article class="article">
            <div class="article-img">
             
            </div>
            <div class="article-title">
              <h6><a href="#">The loai</a></h6>
              <h2>Tieu de bai dang</h2>
              <div class="media">
                <div class="avatar">
                  <img src="@Model.Avatar" title="" alt="">
                </div>
                <div class="media-body row-cols-3">
                  <label class="col-lg-12">@Model.user</label>
                  <span class="col-lg-2" style="display: inline; margin-right: 10px;">@Model.ngay_dang</span>
                  <span class="col-lg-2" style="display: inline; margin-right: 10px;">@Model.so_binh_luan lượt bình luận
                    <i class="fa-regular fa-eye"></i>
                  </span>
                  <span class="col-lg-2" style="display: inline;">@Model.SoLike lượt thích
                    <i class="fa-regular fa-thumbs-up"></i>
                  </span>
                </div>
              </div>
            </div>
            <div id="demo" class="carousel slide" data-bs-ride="carousel">
              <!-- Indicators/dots -->
              <div class="carousel-indicators">

              </div>
              <!-- The slideshow/carousel -->
              <div class="carousel-inner">

              </div>
              <!-- Left and right controls/icons -->
              <button class="carousel-control-prev" type="button" data-bs-target="#demo" data-bs-slide="prev">
                <span class="carousel-control-prev-icon"></span>
              </button>
              <button class="carousel-control-next" type="button" data-bs-target="#demo" data-bs-slide="next">
                <span class="carousel-control-next-icon"></span>
              </button>
            </div>
            <div id="Noi_dung" class="article-content">
             
            </div>
            

          </article>

        </div>
        <div class="col-lg-4 m-15px-tb blog-aside " id="blogaside">
          <!-- Author -->
          <div class="widget widget-author">
            <div class="widget-title">
              <h3 onclick="window.location.href='/Home/LogIn'"  style="cursor:pointer;"><i  class="fa-solid fa-circle-left" style="margin-right: 10px;cursor:pointer;"></i>Back to home</h3>
            </div>
            <div class="widget-body">
              <div class="media align-items-center">
                <div class="avatar">
                  <img src="@Model.Avatar" title="" alt="">
                </div>
                <div class="media-body">
                  <h6>Hello, I'm  User</h6>
                </div>
              </div>
             
            </div>
          </div>
          <div class="contact-form article-comment mt-3" id="fixedWhenscroll" style="overflow: auto;">
            <h4>Để lại bình luận</h4>
            <form id="contact-form" method="POST">
              <div class="row">
                <div class="col-md-12">
                  <div class="form-group">
                    <textarea name="message" id="message" placeholder="Bình luận " rows="1"
                      class="form-control"></textarea>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="send">
                    <button onclick="sendData(event)" class="btn btn-outline-primary btn_chinhbangcss" style="min-width: 120px;height:45px;">
                      <div>Gửi <i class="fa-solid fa-paper-plane" style="margin-left:10px;"></i></div>
                    </button>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="send">
                       <button class="btn btn-outline-primary btn_chinhbangcss" style="min-width: 120px;height:45px;margin-left:40px;" onclick="sendLike(event, '@Model.Like', '@Model.Ma_bai_viet')">
                         <div>Like<i class="fa-regular fa-thumbs-up" style="margin-left:10px"></i></div>
                    </button>
                  </div>
                </div>
              </div>
            </form>

            <div class="Comments m-3">

               <h3>So Comment</h3>
              <h3>Binh luan</h3>
              <div id="content" class="container"></div>
             
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
  <script>
    
     function sendLike(event, likeStatus, postId) {
  event.preventDefault();
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function () {
    if (this.readyState == 4 && this.status == 200) {
      var response = JSON.parse(this.responseText);
      alert('Ok');
      location.reload();
    }
  };
  var url = likeStatus === 'like' ? "/Home/like" : "/Home/notlike";
  xhttp.open("POST", url, true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send("id=" + postId);
}

  </script>
</body>
<script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
<script>
  


  function insertParagraphs(contentArray) {
    console.log("OK");
    const container = document.getElementById("Noi_dung");
    container.innerHTML = ""; // Clear existing content
    contentArray.forEach(paragraph => {
      if (paragraph.trim()) { // Check if paragraph is not empty or just whitespace
        const newParagraph = document.createElement("p");
        newParagraph.textContent = paragraph;

        container.insertAdjacentHTML("beforeend", "<p>" + paragraph + "</p>");
      }
    });
  }
  function insertimage(imageArray) {
    console.log("OK");
    const containers = document.getElementsByClassName("carousel-inner");
    const indicators = document.getElementsByClassName("carousel-indicators");
    if (containers.length > 0) {
      const container = containers[0]; // Get the first element
      const indicator = indicators[0]; // Get the first element of indicators
      container.innerHTML = ""; // Clear existing content
      indicator.innerHTML = ""; // Clear existing indicators
      imageArray.forEach((image, index) => {
        if (image.trim()) {
          const className = index === 0 ? "carousel-item active" : "carousel-item";
          const activeClass = index === 0 ? "active" : "";
          container.insertAdjacentHTML("beforeend", '<div class="' + className + '"><video width="500" height="300" controls alt="Slide ' + (index + 1) + '" class="d-block w-100"> <source src="' + image + '" type="video/mp4" ></video></div>');
          indicator.insertAdjacentHTML("beforeend", '<button type="button" data-bs-target="#demo" data-bs-slide-to="' + index + '" class="' + activeClass + '"></button>');
        }
      });
    }
  }


  window.onload = function () {
    console.log("OK"); var contentArray = JSON.parse('@Html.Raw(jsonForJs)');
    var imageArray = JSON.parse('@Html.Raw(jsonimage)');
    // Call the function with proper escaping for Razor syntax
    insertParagraphs(contentArray);
    insertimage(imageArray);
    Comment();
  };
  // sự kiện khi cuộn
  window.addEventListener("scroll", () => {
    element = document.getElementById('blogaside');
    const sizeElement = element.offsetWidth;
    console.log(sizeElement);
    if (sizeElement == 380) {
      const a = window.scrollY;
      if (a >= 392) {
        var fixedwhenscroll = document.getElementById('fixedWhenscroll');
        fixedwhenscroll.classList.add('scroll-activated');
      }
      else {
        var fixedwhenscroll = document.getElementById('fixedWhenscroll');
        fixedwhenscroll.classList.remove('scroll-activated');
      }
    }
    else {
      var fixedwhenscroll = document.getElementById('fixedWhenscroll');
      fixedwhenscroll.classList.remove('scroll-activated');
    }
  })
</script>

</html>